(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{45:function(e,t,r){e.exports=r(99)},50:function(e,t,r){},51:function(e,t,r){},53:function(e,t,r){},54:function(e,t,r){},55:function(e,t,r){},56:function(e,t,r){},95:function(e,t,r){},96:function(e,t,r){},97:function(e,t,r){},98:function(e,t,r){},99:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(20),s=r.n(o),i=(r(50),r(51),r(7)),c=r(6),l=r(1),u=r(2),p=r(4),m=r(3),f=r(5),h=r(8),d=r.n(h),v=(r(53),function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("h1",{className:"header"},"Piskel Clone")}}]),t}(a.Component)),b=(r(54),r(55),function(e){function t(){var e,r;Object(l.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).setSize=function(e){r.props.setSize(e.target.value)},r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"tools__canvas-size",onClick:this.setSize},n.a.createElement("button",{value:32},"32x32"),n.a.createElement("button",{value:64},"64x64"),n.a.createElement("button",{value:128},"128x128"))}}]),t}(a.Component)),g=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"tools__basic"},n.a.createElement("button",{className:"tools__button ".concat("pen"===this.props.highlight?"tools__highlight":""),value:"pen"},"Pen"),n.a.createElement("button",{className:"tools__button ".concat("eraser"===this.props.highlight?"tools__highlight":""),value:"eraser"},"Eraser"),n.a.createElement("button",{className:"tools__button ".concat("paintBucket"===this.props.highlight?"tools__highlight":""),value:"paintBucket"},"PaintB"),n.a.createElement("button",{className:"tools__button ".concat("paintAllPixels"===this.props.highlight?"tools__highlight":""),value:"paintAllPixels"},"AllPix"),n.a.createElement("button",{className:"tools__button ".concat("pipette"===this.props.highlight?"tools__highlight":""),value:"pipette"},"Pip"),n.a.createElement("button",{className:"tools__button ".concat("line"===this.props.highlight?"tools__highlight":""),value:"line"},"Line"),n.a.createElement("button",{className:"tools__button ".concat("circle"===this.props.highlight?"tools__highlight":""),value:"circle"},"O"),n.a.createElement("button",{className:"tools__button ".concat("rectangle"===this.props.highlight?"tools__highlight":""),value:"rectangle"},"[_]"))}}]),t}(a.Component),C=function(e){function t(){var e,r;Object(l.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).setFirstColor=function(e){e.persist(),r.props.setColor({firstColor:e.target.value,secondColor:r.props.colors.secondColor})},r.setSecondColor=function(e){e.persist(),r.props.setColor({firstColor:r.props.colors.firstColor,secondColor:e.target.value})},r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"tools__color"},n.a.createElement("input",{className:"tools__firstColor",type:"color",value:this.props.colors.firstColor,onChange:this.setFirstColor}),n.a.createElement("input",{className:"tools__secondColor",type:"color",value:this.props.colors.secondColor,onChange:this.setSecondColor}))}}]),t}(a.Component),F=function(e){function t(){var e,r;Object(l.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).selectTool=function(e){r.setState({selectedTool:e.target.value}),r.props.selectTool(e.target.value)},r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"tools"},n.a.createElement(b,{setSize:this.props.setFrameSize}),n.a.createElement("div",{className:"tools__tool-box",onClick:this.selectTool},n.a.createElement(g,{highlight:this.props.selectedTool})),n.a.createElement(C,{colors:this.props.colors,setColor:this.props.setColor}))}}]),t}(a.Component),S=r(9),O=r(15),j=function(e,t,r,a){var n=Math.round(r/a),o=e.current.getContext("2d");o.clearRect(0,0,r,r),t.forEach(function(e,t){e.forEach(function(e,r){o.fillStyle=e,o.fillRect(n*r,n*t,n,n)})})};function E(e,t){for(var r=Object(S.a)(e,2),a=r[0],n=r[1],o=Object(S.a)(t,2),s=o[0],i=o[1],c=Math.abs(s-a),l=Math.abs(i-n),u=a<s?1:-1,p=n<i?1:-1,m=c-l,f=[];f.push([a,n]),a!==s||n!==i;){var h=2*m;h>-l&&(m-=l,a+=u),h<c&&(m+=c,n+=p)}return f}r(56);var y=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e))).updateCanvas=function(){j(r.frameRef,r.props.frame,r.canvasSize,r.props.frameSize)},r.canvasSize=128,r.frameRef=n.a.createRef(),r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"render",value:function(){var e=this,t=this.props.highlight?"single-frame_canvas highlight":"single-frame_canvas";return n.a.createElement(O.b,{draggableId:this.props.index+1,index:this.props.index,key:this.props.index},function(r){return n.a.createElement("div",Object.assign({className:"single-frame",ref:r.innerRef},r.draggableProps,r.dragHandleProps),n.a.createElement("canvas",{className:t,onClick:e.props.select(e.props.index),width:e.canvasSize,height:e.canvasSize,ref:e.frameRef}),n.a.createElement("div",{className:"single-frame_index"},e.props.index+1),e.props.framesCount>1?n.a.createElement("div",{className:"single-frame_delete",onClick:e.props.delete(e.props.index)},"X"):void 0,n.a.createElement("div",{className:"single-frame_double",onClick:e.props.duplicate(e.props.index)},"x2"))})}}]),t}(a.Component),_=(r(95),function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e))).addFrame=function(){var e=Array.from({length:r.props.frameSize},function(){return Array.from({length:r.props.frameSize},function(){return"#a9a9a9"})});r.props.updateFrames([].concat(Object(i.a)(r.props.listFrames),[e])),r.props.selectCurrentFrame(r.props.listFrames.length)},r.reversFrame=function(){r.setState(function(e){return Object(c.a)({},e,{reversed:!e.reversed})})},r.deleteFrame=function(e){return function(){var t=Object(i.a)(r.props.listFrames);t.splice(e,1),r.props.currentFrameId>t.length-1&&r.props.selectCurrentFrame(t.length-1),r.props.updateFrames(t)}},r.duplicateFrame=function(e){return function(){var t=Object(i.a)(r.props.listFrames);t.splice(e,0,d.a.cloneDeep(t[e])),r.props.updateFrames(t),r.props.selectCurrentFrame(e+1)}},r.selectFrame=function(e){return function(){r.props.selectCurrentFrame(e)}},r.reorder=function(e,t,r){var a=Array.from(e),n=a.splice(t,1),o=Object(S.a)(n,1)[0];return a.splice(r,0,o),a},r.onDragEnd=function(e){if(e.destination){var t=r.reorder(r.props.listFrames,e.source.index,e.destination.index);r.props.updateFrames(t),r.props.selectCurrentFrame(e.destination.index)}},r.state={reversed:!1},r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state.reversed,r=t?Object(i.a)(this.props.listFrames).reverse():this.props.listFrames;return n.a.createElement(O.a,{onDragEnd:this.onDragEnd},n.a.createElement(O.c,{droppableId:"droppableId"},function(a){return n.a.createElement("div",Object.assign({className:"frames"},a.droppableProps,{ref:a.innerRef}),n.a.createElement("div",{className:"frames__buttons"},n.a.createElement("button",{className:"frames__add-frame",onClick:e.addFrame},"Add frame"),n.a.createElement("button",{className:"frames__revers-frame",onClick:e.reversFrame},"Reverse")),r.map(function(a,o){return n.a.createElement(y,{key:t?r.length-o-1:o,index:t?r.length-o-1:o,frame:a,frameSize:e.props.frameSize,delete:e.deleteFrame,duplicate:e.duplicateFrame,select:e.selectFrame,framesCount:e.props.listFrames.length,highlight:(t?r.length-o-1:o)===e.props.currentFrameId})}),a.placeholder)}))}}]),t}(a.Component));function z(e,t,r){for(var a=Object(S.a)(t,2),n=a[0],o=a[1],s=[],i=n-1;i<=n+1;i+=1)for(var c=o-1;c<=o+1;c+=1)e.length<1||i<0||c<0||i>=e[0].length||c>=e.length||e[c][i]===r&&(n!==i&&o!==c&&e[o][i]!==r&&e[c][n]!==r||s.push([i,c]));return s}r(96);var w={line:{func:E},circle:{func:function(e,t){var r=Object(S.a)(e,2),a=r[0],n=r[1],o=Object(S.a)(t,2),s=o[0],i=o[1],c=Math.floor(Math.sqrt(Math.pow(s-a,2)+Math.pow(i-n,2))),l=1-c,u=0,p=-2*c,m=0,f=c,h=[];for(h.push([a,n+c]),h.push([a,n-c]),h.push([a+c,n]),h.push([a-c,n]);m<f;)l>=0&&(f-=1,l+=p+=2),m+=1,l+=(u+=2)+1,h.push([a+m,n+f]),h.push([a-m,n+f]),h.push([a+m,n-f]),h.push([a-m,n-f]),h.push([a+f,n+m]),h.push([a-f,n+m]),h.push([a+f,n-m]),h.push([a-f,n-m]);return h}},rectangle:{func:function(e,t){var r=Object(S.a)(e,2),a=r[0],n=r[1],o=Object(S.a)(t,2),s=o[0],c=o[1],l=[];return l.push.apply(l,Object(i.a)(E([a,n],[s,n]))),l.push.apply(l,Object(i.a)(E([a,n],[a,c]))),l.push.apply(l,Object(i.a)(E([s,n],[s,c]))),l.push.apply(l,Object(i.a)(E([a,c],[s,c]))),l}}},k=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e))).onMouseDown=function(e){r.pixelSize=Math.round(r.canvasSize/r.props.frameSize),e.preventDefault(),r.mouseDown=!0,r.mouseLived=!1;var t=Math.floor(e.offsetX/r.pixelSize),a=Math.floor(e.offsetY/r.pixelSize),n=r.props.currentFrame,o=1===e.buttons?r.props.colors.firstColor:r.props.colors.secondColor;r.props.setStartDrawPoint({coords:[t,a],color:o}),"pen"===r.props.selectedTool&&e.buttons>0&&(n[a][t]=r.props.startDrawPoint.color,r.updateCurrentFrame(n),r.previousPoint=[t,a]),"eraser"===r.props.selectedTool&&1===e.buttons&&(n[a][t]="#a9a9a9",r.updateCurrentFrame(n))},r.onMouseMove=function(e){r.pixelSize=Math.round(r.canvasSize/r.props.frameSize);var t=Math.floor(e.offsetX/r.pixelSize),a=Math.floor(e.offsetY/r.pixelSize),n=r.props.currentFrame;if(r.setState(function(e){return Object(c.a)({},e,{coords:[t,a]})}),r.mouseDown){if("pen"===r.props.selectedTool&&e.buttons>0)E(r.previousPoint||[t,a],[t,a]).forEach(function(t){n[t[1]][t[0]]=1===e.buttons?r.props.colors.firstColor:r.props.colors.secondColor}),r.previousPoint=[t,a],r.updateCurrentFrame(n);if("eraser"===r.props.selectedTool&&1===e.buttons)r.previousPoint=[t,a],E(r.previousPoint,[t,a]).forEach(function(e){n[e[1]][e[0]]="#a9a9a9"}),r.updateCurrentFrame(n);r.props.selectedTool in w&&e.buttons>0&&r.drawFigure([t,a],n,r.props.startDrawPoint.color)}},r.onMouseClick=function(e){e.preventDefault();var t=Math.floor(e.offsetX/r.pixelSize),a=Math.floor(e.offsetY/r.pixelSize),n=r.props.currentFrame,o=n[a][t];"paintBucket"===r.props.selectedTool&&e.buttons>=0&&(function(e,t,r){for(var a=[t],n=new Set([d.a.join(t)]);a.length>0;)z(e,a.pop(),r).forEach(function(e){var t=d.a.join(e);n.has(t)||(n.add(t),a.push(e))});for(var o=[],s=n.values(),i=s.next().value;i;)o.push(d.a.split(i,",").map(Number)),i=s.next().value;return o}(n,[t,a],o).forEach(function(t){var a=Object(S.a)(t,2),o=a[0],s=a[1];n[s][o]=d.a.cloneDeep(0===e.buttons?r.props.colors.firstColor:r.props.colors.secondColor)}),r.updateCurrentFrame(n));if("paintAllPixels"===r.props.selectedTool&&e.buttons>=0){var s=n.map(function(t){return t.map(function(t){var a=t;return a===o&&(a=0===e.buttons?r.props.colors.firstColor:r.props.colors.secondColor),a})});r.updateCurrentFrame(s)}if("pipette"===r.props.selectedTool&&e.buttons>=0){var i=r.props.colors;0===e.buttons?i.firstColor=o:i.secondColor=o,r.props.setColor(i)}},r.onMouseUp=function(e){r.mouseDown=!1;var t=Math.floor(e.offsetX/r.pixelSize),a=Math.floor(e.offsetY/r.pixelSize),n=r.props.currentFrame;r.props.selectedTool in w&&!r.mouseLived&&r.drawFigure([t,a],n,r.props.startDrawPoint.color,!0)},r.onMouseLeave=function(e){var t=Math.floor(e.offsetX/r.pixelSize),a=Math.floor(e.offsetY/r.pixelSize),n=r.props.currentFrame;r.props.selectedTool in w&&r.mouseDown&&r.drawFigure([t,a],n,r.props.startDrawPoint.color,!0),r.mouseLived=!0,r.mouseDown=!1,r.setState(function(e){return Object(c.a)({},e,{coords:[0,0]})})},r.onDrag=function(e){e.preventDefault()},r.updateCanvas=function(){j(r.myRef,r.state.overlay||r.props.currentFrame,r.canvasSize,r.props.frameSize)},r.myRef=n.a.createRef(),r.canvasSize=639,r.state={coords:[0,0],shotUpdate:!0},r.pixelSize=Math.round(r.canvasSize/r.props.frameSize),r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"updateCurrentFrame",value:function(e){this.props.updateCurrentFrame(e)}},{key:"drawFigure",value:function(e,t,r){var a,n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.props.startDrawPoint.coords,i=w[this.props.selectedTool].func(s,e);a=this.props.frameSize,i=i.filter(function(e){return e[0]<a&&e[0]>=0&&e[1]<a&&e[1]>=0});var l=d.a.cloneDeep(t);i.forEach(function(e){l[e[1]][e[0]]=r}),o?this.setState(function(e){return Object(c.a)({},e,{overlay:void 0})},function(){n.updateCurrentFrame(l)}):this.setState(function(e){return Object(c.a)({},e,{overlay:l})})}},{key:"componentDidMount",value:function(){this.ctx=this.myRef.current.getContext("2d"),this.myRef.current.ondrag=function(e){e.preventDefault()},this.updateCanvas(),this.myRef.current.addEventListener("mousedown",this.onMouseDown),this.myRef.current.addEventListener("mousemove",this.onMouseMove),this.myRef.current.addEventListener("mouseleave",this.onMouseLeave),this.myRef.current.addEventListener("mouseup",this.onMouseUp),this.myRef.current.addEventListener("click",this.onMouseClick),this.myRef.current.addEventListener("contextmenu",this.onMouseClick),this.myRef.current.addEventListener("drag",this.onDrag)}},{key:"componentWillUnmount",value:function(){this.myRef.current.removeEventListener("mousedown",this.onMouseDown),this.myRef.current.removeEventListener("mousemove",this.onMouseMove),this.myRef.current.removeEventListener("mouseleave",this.onMouseLeave),this.myRef.current.removeEventListener("mouseup",this.onMouseUp),this.myRef.current.removeEventListener("click",this.onMouseClick),this.myRef.current.removeEventListener("contextmenu",this.onMouseClick),this.myRef.current.removeEventListener("drag",this.onDrag)}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"render",value:function(){return n.a.createElement("div",{className:"draw"},n.a.createElement("div",{className:"draw__new-sprite",onClick:this.props.clearLocalStorage},"Start new sprite"),n.a.createElement("canvas",{ref:this.myRef,className:"draw__canvas",width:this.canvasSize,height:this.canvasSize}),n.a.createElement("div",null,"[",this.props.frameSize," x ",this.props.frameSize,"] ",this.state.coords[0]," : ",this.state.coords[1]))}}]),t}(a.Component),x=(r(97),function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e))).drawOneFrame=function(e){j(r.animRef,e,r.canvasSize,r.props.frameSize)},r.animate=function(){r.props.listFrames&&r.props.listFrames.length>0&&(r.props.listFrames[r.step]?(r.drawOneFrame(r.props.listFrames[r.step]),r.step+=1):(r.drawOneFrame(r.props.listFrames[0]),r.step=1)),r.animationTimeout=setTimeout(function(){return window.requestAnimationFrame(r.animate)},1e3/r.state.fps)},r.fpsChangeHandler=function(e){r.setState({fps:e.target.value})},r.animRef=n.a.createRef(),r.canvasSize=256,r.state={fps:2},r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.animate()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.animationTimeout)}},{key:"render",value:function(){return n.a.createElement("div",{className:"animation"},n.a.createElement("canvas",{ref:this.animRef,className:"animation__canvas",width:this.canvasSize,height:this.canvasSize}),n.a.createElement("input",{className:"animation__fps-range",onChange:this.fpsChangeHandler,id:"fps-range",value:this.state.fps,type:"range",min:1,max:24}),n.a.createElement("label",{htmlFor:"fps-range"},this.state.fps," FPS"))}}]),t}(a.Component)),M=(r(98),function(e){return Array.from({length:e},function(){return Array.from({length:e},function(){return"#a9a9a9"})})}),D={currentFrameId:0,listFrames:[M(32)],frameSize:32,colors:{firstColor:"#ffffff",secondColor:"#000000"},tool:"pen"},N=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(p.a)(this,Object(m.a)(t).call(this,e))).updateFrames=function(e){r.setState(function(t){return Object(c.a)({},t,{listFrames:e})})},r.selectCurrentFrame=function(e){r.setState(function(t){return Object(c.a)({},t,{currentFrameId:e})})},r.updateCurrentFrame=function(e){r.setState(function(t){var a=Object(i.a)(r.state.listFrames);return a[r.state.currentFrameId]=e,Object(c.a)({},t,{listFrames:a})})},r.selectTool=function(e){r.setState(function(t){return Object(c.a)({},t,{tool:e})})},r.setColor=function(e){r.setState(function(t){return Object(c.a)({},t,{colors:e})})},r.setStartDrawPoint=function(e){r.setState(function(t){return Object(c.a)({},t,{startDrawPoint:e})})},r.setFrameSize=function(e){if(e-r.state.frameSize!==0){var t=d.a.cloneDeep(r.state.listFrames),a=[];t.forEach(function(t){var n=M(e).map(function(a,n){var o=Object(i.a)(a);return t[n]&&o.splice.apply(o,[0,r.state.frameSize].concat(Object(i.a)(t[n]))),o.length=e,o});a.push(n)}),r.setState(function(t){return Object(c.a)({},t,{frameSize:e,listFrames:a})})}},r.save=function(){localStorage.clear(),localStorage.setItem("state",JSON.stringify(r.state))},r.clearLocalStorage=function(){r.setState(D),r.save()},r.state=JSON.parse(localStorage.getItem("state"))||d.a.cloneDeep(D),r}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.save(),n.a.createElement("div",{className:"main-app"},n.a.createElement(v,null),n.a.createElement(F,{setFrameSize:this.setFrameSize,selectTool:this.selectTool,selectedTool:this.state.tool,colors:this.state.colors,setColor:this.setColor}),n.a.createElement(_,{frameSize:this.state.frameSize,listFrames:this.state.listFrames,currentFrameId:this.state.currentFrameId,updateFrames:this.updateFrames,selectCurrentFrame:this.selectCurrentFrame}),n.a.createElement(k,{frameSize:this.state.frameSize,currentFrame:this.state.listFrames[this.state.currentFrameId],updateCurrentFrame:this.updateCurrentFrame,clearLocalStorage:this.clearLocalStorage,selectedTool:this.state.tool,colors:this.state.colors,setColor:this.setColor,startDrawPoint:this.state.startDrawPoint,setStartDrawPoint:this.setStartDrawPoint,key:"".concat(this.state.currentFrameId,"/").concat(this.state.listFrames.length)}),n.a.createElement(x,{frameSize:this.state.frameSize,listFrames:this.state.listFrames}))}}]),t}(a.Component);var R=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement(N,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[45,1,2]]]);
//# sourceMappingURL=main.dd93294d.chunk.js.map